# ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Search Error - 13 –û–∫—Ç—è–±—Ä—è 2025

## üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –û—à–∏–±–∫–∞ (–ò–°–ü–†–ê–í–õ–ï–ù–û)

### **–ü—Ä–æ–±–ª–µ–º–∞:**
```
ERROR Search error: {
  "code": "22P02",
  "details": null,
  "hint": null,
  "message": "invalid input syntax for type numeric: \"undefined\""
}
```

**–õ–æ–∫–∞—Ü–∏—è:**
- `services/supabase.ts:50` (handleSupabase)
- `app/(tabs)/search.tsx:102` (console.error)

**–ü—Ä–∏—á–∏–Ω–∞:**
–í —Ñ—É–Ω–∫—Ü–∏–∏ `searchCars()` –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–ª—è —á–∏—Å–ª–æ–≤—ã—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤ –±—ã–ª–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏:
```typescript
// ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û (—Å—Ç–∞—Ä—ã–π –∫–æ–¥):
if (minPrice !== null) {
  query = query.gte('price', minPrice);  // undefined –ø—Ä–æ—Ö–æ–¥–∏—Ç –ø—Ä–æ–≤–µ—Ä–∫—É!
}
```

–ö–æ–≥–¥–∞ `minPrice` –±—ã–ª `undefined`, –ø—Ä–æ–≤–µ—Ä–∫–∞ `!== null` –≤–æ–∑–≤—Ä–∞—â–∞–ª–∞ `true`, –∏ `undefined` –ø–µ—Ä–µ–¥–∞–≤–∞–ª—Å—è –≤ `.gte()`, —á—Ç–æ –≤—ã–∑—ã–≤–∞–ª–æ –æ—à–∏–±–∫—É PostgreSQL.

---

## üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. **services/supabase.ts - —Ñ—É–Ω–∫—Ü–∏—è `searchCars()` (—Å—Ç—Ä–æ–∫–∏ 354-368)**

**–ë—ã–ª–æ:**
```typescript
// –§–∏–ª—å—Ç—Ä –ø–æ —Ü–µ–Ω–µ
if (minPrice !== null) {
  query = query.gte('price', minPrice);
}
if (maxPrice !== null) {
  query = query.lte('price', maxPrice);
}

// –§–∏–ª—å—Ç—Ä –ø–æ –≥–æ–¥—É
if (minYear !== null) {
  query = query.gte('year', minYear);
}
if (maxYear !== null) {
  query = query.lte('year', maxYear);
}
```

**–°—Ç–∞–ª–æ:**
```typescript
// –§–∏–ª—å—Ç—Ä –ø–æ —Ü–µ–Ω–µ
if (minPrice != null && minPrice !== undefined) {
  query = query.gte('price', minPrice);
}
if (maxPrice != null && maxPrice !== undefined) {
  query = query.lte('price', maxPrice);
}

// –§–∏–ª—å—Ç—Ä –ø–æ –≥–æ–¥—É
if (minYear != null && minYear !== undefined) {
  query = query.gte('year', minYear);
}
if (maxYear != null && maxYear !== undefined) {
  query = query.lte('year', maxYear);
}
```

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- ‚úÖ `!== null` ‚Üí `!= null && !== undefined`
- ‚úÖ –¢–µ–ø–µ—Ä—å –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –æ–±–∞ —Å–ª—É—á–∞—è: `null` –ò `undefined`
- ‚úÖ `undefined` –±–æ–ª—å—à–µ –Ω–µ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ `.gte()` –∏ `.lte()`

---

### 2. **services/supabase.ts - —Ñ—É–Ω–∫—Ü–∏—è `getCars()` (—Å—Ç—Ä–æ–∫–∏ 227-228)**

**–ë—ã–ª–æ:**
```typescript
if (minPrice) query = query.gte('price', minPrice);
if (maxPrice) query = query.lte('price', maxPrice);
```

**–°—Ç–∞–ª–æ:**
```typescript
if (minPrice != null && minPrice !== undefined) query = query.gte('price', minPrice);
if (maxPrice != null && maxPrice !== undefined) query = query.lte('price', maxPrice);
```

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- ‚úÖ –ë–æ–ª–µ–µ —è–≤–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –ø—Ä–æ–±–ª–µ–º —Å falsy –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
- ‚úÖ –¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –∏—Å–∫–∞—Ç—å —Ç–æ–≤–∞—Ä—ã —Å —Ü–µ–Ω–æ–π `0` (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

---

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ:
- ‚úÖ –ü–æ–∏—Å–∫ –±–µ–∑ —Ñ–∏–ª—å—Ç—Ä–æ–≤ - —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –ü–æ–∏—Å–∫ —Å —Ñ–∏–ª—å—Ç—Ä–æ–º –ø–æ —Ü–µ–Ω–µ - —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –ü–æ–∏—Å–∫ —Å —Ñ–∏–ª—å—Ç—Ä–æ–º –ø–æ –≥–æ–¥—É - —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –ü–æ–∏—Å–∫ —Å–æ –≤—Å–µ–º–∏ —Ñ–∏–ª—å—Ç—Ä–∞–º–∏ - —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –õ–∏–Ω—Ç–µ—Ä –ø—Ä–æ–≤–µ—Ä–µ–Ω - –Ω–µ—Ç –æ—à–∏–±–æ–∫

### –ß—Ç–æ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç:
```typescript
// –í—Å–µ —ç—Ç–∏ —Å–ª—É—á–∞–∏ —Ç–µ–ø–µ—Ä—å –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ:
await db.searchCars({
  minPrice: undefined,    // ‚úÖ –ò–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è
  maxPrice: null,         // ‚úÖ –ò–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è
  minYear: 2020,          // ‚úÖ –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è
  maxYear: 0,             // ‚úÖ –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è (—Ö–æ—Ç—è –º–∞–ª–æ–≤–µ—Ä–æ—è—Ç–Ω–æ)
});
```

---

## ‚ö†Ô∏è –û—Å—Ç–∞–≤—à–∏–µ—Å—è Warnings (–ù–µ –ö—Ä–∏—Ç–∏—á–Ω–æ)

### 1. **Require Cycle –≤ Comments**
```
WARN Require cycle: components/Comments/CommentItem.tsx
-> components/Comments/CommentThread.tsx 
-> components/Comments/CommentItem.tsx
```

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è –û—Å—Ç–∞–≤–ª–µ–Ω–æ –∫–∞–∫ –µ—Å—Ç—å  
**–ü—Ä–∏—á–∏–Ω–∞:** –¢—Ä–µ–±—É–µ—Ç —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞, –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å  
**–†–µ—à–µ–Ω–∏–µ (–Ω–∞ –±—É–¥—É—â–µ–µ):**
- –í—ã–Ω–µ—Å—Ç–∏ —Ç–∏–ø—ã `Comment` –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª `types/comments.ts`
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –∏–º–ø–æ—Ä—Ç –¥–ª—è `CommentThread`

---

### 2. **expo-av Deprecated**
```
‚ö†Ô∏è [expo-av]: Video component from `expo-av` is deprecated 
in favor of `expo-video`
```

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è –û—Å—Ç–∞–≤–ª–µ–Ω–æ –∫–∞–∫ –µ—Å—Ç—å  
**–ü—Ä–∏—á–∏–Ω–∞:** –¢—Ä–µ–±—É–µ—Ç –∑–∞–º–µ–Ω—ã –≤—Å–µ—Ö –≤–∏–¥–µ–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤  
**–†–µ—à–µ–Ω–∏–µ (–Ω–∞ –±—É–¥—É—â–µ–µ):**
- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `expo-video` –∏ `expo-audio`
- –ó–∞–º–µ–Ω–∏—Ç—å `<Video>` –Ω–∞ –Ω–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- –û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ –∏–º–ø–æ—Ä—Ç—ã

---

## üìä –ò—Ç–æ–≥–æ–≤–∞—è –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

| –ü—Ä–æ–±–ª–µ–º–∞ | –§–∞–π–ª | –°—Ç—Ä–æ–∫–∏ | –°—Ç–∞—Ç—É—Å |
|----------|------|--------|--------|
| Search undefined error | services/supabase.ts | 355-368 | ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ |
| getCars undefined error | services/supabase.ts | 227-228 | ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ |
| Require cycle | CommentItem.tsx | 2 | ‚ö†Ô∏è Warning |
| expo-av deprecated | –í—Å–µ Video –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã | - | ‚ö†Ô∏è Warning |

---

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ –®–∞–≥–∏

### –î–ª—è –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

1. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:**
   ```bash
   # –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ç–µ–∫—É—â–∏–π –ø—Ä–æ—Ü–µ—Å—Å (Ctrl+C)
   npx expo start --clear
   ```

2. **–û—Ç–∫—Ä–æ–π—Ç–µ —ç–∫—Ä–∞–Ω Search:**
   - –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É "–ü–æ–∏—Å–∫"
   - –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Ä–∞–∑–Ω—ã–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:**
   - ‚úÖ –ü–æ–∏—Å–∫ –±–µ–∑ —Ñ–∏–ª—å—Ç—Ä–æ–≤
   - ‚úÖ –§–∏–ª—å—Ç—Ä –ø–æ —Ü–µ–Ω–µ (min/max)
   - ‚úÖ –§–∏–ª—å—Ç—Ä –ø–æ –≥–æ–¥—É (min/max)
   - ‚úÖ –ö–æ–º–±–∏–Ω–∞—Ü–∏—è —Ñ–∏–ª—å—Ç—Ä–æ–≤
   - ‚úÖ –°–±—Ä–æ—Å —Ñ–∏–ª—å—Ç—Ä–æ–≤

4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å:**
   - –ù–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—à–∏–±–æ–∫ `"invalid input syntax"`
   - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞ –¥–æ–ª–∂–Ω—ã –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

## üéØ TypeScript Tips

### –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–ª—è –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:

```typescript
// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∏ null, –∏ undefined:
if (value != null) { /* ... */ }
if (value != null && value !== undefined) { /* ... */ }

// ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û - –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç undefined:
if (value !== null) { /* ... */ }

// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û - –¥–ª—è —Å—Ç—Ä–æ–∫ –∏ —á–∏—Å–µ–ª:
if (value) { /* ... */ }  // –ù–æ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è 0 –∏–ª–∏ ""

// ‚úÖ –õ–£–ß–®–ò–ô –í–ê–†–ò–ê–ù–¢ - —è–≤–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞:
if (typeof value === 'number') { /* ... */ }
if (typeof value === 'string' && value.length > 0) { /* ... */ }
```

---

**–î–∞—Ç–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:** 13 –æ–∫—Ç—è–±—Ä—è 2025  
**–í–µ—Ä—Å–∏—è:** 2.0.2  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã, –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é

