# ‚úÖ –ß–ï–ö–õ–ò–°–¢ –ü–†–û–í–ï–†–ö–ò SMS

## üîç –ë–´–°–¢–†–ê–Ø –ü–†–û–í–ï–†–ö–ê

### 1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é SMS

```bash
cd backend
npm run check-sms
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
‚úÖ SMS –ø—Ä–æ–≤–∞–π–¥–µ—Ä –Ω–∞—Å—Ç—Ä–æ–µ–Ω
   –ü—Ä–æ–≤–∞–π–¥–µ—Ä: nikita
   –û—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å: bat-bat.kg
   –†–µ–∂–∏–º: production
```

### 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ `backend/.env` –µ—Å—Ç—å:

```bash
# SMS Configuration
SMS_LOGIN=superapp
SMS_PASSWORD=83fb772ee0799a422cce18ffd5f497b9
SMS_SENDER=bat-bat.kg
SMS_API_URL=https://smspro.nikita.kg/api/message

# –í–ê–ñ–ù–û: –î–ª—è —Ä–µ–∞–ª—å–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏
NODE_ENV=production
```

### 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –±—ç–∫–µ–Ω–¥ –∑–∞–ø—É—â–µ–Ω

```bash
cd backend
npm run dev
```

**–ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:**
```
‚úÖ SMS –ø—Ä–æ–≤–∞–π–¥–µ—Ä –Ω–∞—Å—Ç—Ä–æ–µ–Ω
   URL: https://smspro.nikita.kg/api/message
   Login: superapp
   Sender: bat-bat.kg
   Mode: production
```

### 4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ API endpoint

```bash
curl -X POST http://localhost:3001/api/auth/request-code \
  -H "Content-Type: application/json" \
  -d '{"phone": "+996555123456"}'
```

**–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "data": {
    "warning": "SMS –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –Ω–∞ –≤–∞—à –Ω–æ–º–µ—Ä",
    "codeLength": 4
  }
}
```

### 5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ SMS

–ü—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ SMS –≤ –ª–æ–≥–∞—Ö –±—ç–∫–µ–Ω–¥–∞ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å:

```
[AuthAPI] Request code for phone: +996555123456
[AuthService] requestSmsCode called with phone: +996555123456
[AuthService] Formatted phone: +996555123456
[AuthService] Generated code: 1234
[AuthService] Code stored in database, sending SMS...
[AuthService] Phone for SMS (without +): 996555123456
[SMS] sendSms called with phone: 996555123456
[SMS] Normalized phone: 996555123456
[SMS] Response from nikita.kg: { status: 200, ... }
[SMS] SMS —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ!
[AuthService] SMS result: { success: true, ... }
```

## üêõ –ß–ê–°–¢–´–ï –ü–†–û–ë–õ–ï–ú–´

### –ü—Ä–æ–±–ª–µ–º–∞: "SMS –ø—Ä–æ–≤–∞–π–¥–µ—Ä –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω"

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `backend/.env` - –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å `SMS_LOGIN`, `SMS_PASSWORD`, `SMS_SENDER`
2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±—ç–∫–µ–Ω–¥ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è `.env`

### –ü—Ä–æ–±–ª–µ–º–∞: "–í development —Ä–µ–∂–∏–º–µ SMS –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è"

**–†–µ—à–µ–Ω–∏–µ:**
–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –≤ `backend/.env`:
```bash
NODE_ENV=production
```
–ò –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±—ç–∫–µ–Ω–¥.

### –ü—Ä–æ–±–ª–µ–º–∞: "HTTP error" –∏–ª–∏ "–¢–∞–π–º–∞—É—Ç"

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ nikita.kg
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –Ω–∞ —Å—á–µ—Ç—É nikita.kg –µ—Å—Ç—å –±–∞–ª–∞–Ω—Å

### –ü—Ä–æ–±–ª–µ–º–∞: "–û—Ç–ø—Ä–∞–≤–∫–∞ SMS —Ä–∞–∑—Ä–µ—à–µ–Ω–∞ —Ç–æ–ª—å–∫–æ –Ω–∞ –∫—ã—Ä–≥—ã–∑—Å—Ç–∞–Ω—Å–∫–∏–µ –Ω–æ–º–µ—Ä–∞"

**–†–µ—à–µ–Ω–∏–µ:**
–ù–æ–º–µ—Ä –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ —Ñ–æ—Ä–º–∞—Ç–µ:
- `+996XXXXXXXXX`
- `996XXXXXXXXX`
- `0XXXXXXXXX`

## ‚úÖ –í–°–ï –î–û–õ–ñ–ù–û –†–ê–ë–û–¢–ê–¢–¨, –ï–°–õ–ò:

1. ‚úÖ –ë—ç–∫–µ–Ω–¥ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
2. ‚úÖ SMS –ø—Ä–æ–≤–∞–π–¥–µ—Ä –Ω–∞—Å—Ç—Ä–æ–µ–Ω (–ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ)
3. ‚úÖ `NODE_ENV=production` –¥–ª—è —Ä–µ–∞–ª—å–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏
4. ‚úÖ –í—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
5. ‚úÖ –ë—ç–∫–µ–Ω–¥ –∑–∞–ø—É—â–µ–Ω –∏ —Å–ª—É—à–∞–µ—Ç –ø–æ—Ä—Ç 3001
6. ‚úÖ –ö–ª–∏–µ–Ω—Ç –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º—É API URL

## üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï

### –¢–µ—Å—Ç 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
```bash
cd backend
npm run check-sms
```

### –¢–µ—Å—Ç 2: –¢–µ—Å—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏ SMS (—Ç–æ–ª—å–∫–æ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏!)
```bash
cd backend
npm run test-sms 996555123456
```

### –¢–µ—Å—Ç 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ API
```bash
curl -X POST http://localhost:3001/api/auth/request-code \
  -H "Content-Type: application/json" \
  -d '{"phone": "+996555123456"}'
```

## üìä –°–¢–ê–¢–£–° SMS –ü–†–û–í–ê–ô–î–ï–†–ê

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å —á–µ—Ä–µ–∑ API:

```bash
curl http://localhost:3001/api/auth/sms-status
```

**–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "data": {
    "status": {
      "configured": true,
      "provider": "nikita",
      "sender": "bat-bat.kg"
    },
    "codeLength": 4
  }
}
```

