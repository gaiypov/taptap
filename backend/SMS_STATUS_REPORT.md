# üìä –û–¢–ß–ï–¢ –û –°–û–°–¢–û–Ø–ù–ò–ò SMS –°–ò–°–¢–ï–ú–´

## ‚úÖ –ß–¢–û –ü–†–û–í–ï–†–ï–ù–û –ò –ò–°–ü–†–ê–í–õ–ï–ù–û:

### 1. ‚úÖ TypeScript –æ—à–∏–±–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã
- –î–æ–±–∞–≤–ª–µ–Ω—ã —Ç–∏–ø—ã –¥–ª—è `req` –∏ `res` –≤ `asyncHandler`
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ Zod
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ `result.user`

### 2. ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ –Ω–∞ –≤—Å–µ—Ö —ç—Ç–∞–ø–∞—Ö
- `[AuthAPI]` - –∑–∞–ø—Ä–æ—Å –Ω–∞ API endpoint
- `[AuthService]` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤ —Å–µ—Ä–≤–∏—Å–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏  
- `[SMS]` - –æ—Ç–ø—Ä–∞–≤–∫–∞ —á–µ—Ä–µ–∑ nikita.kg
- –î–µ—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏ –Ω–∞ –∫–∞–∂–¥–æ–º —ç—Ç–∞–ø–µ

### 3. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ SMS –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è, –µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–µ–∂–∏–º–µ —Ä–∞–±–æ—Ç—ã

### 4. ‚úÖ –£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–∞ –æ—Ç nikita.kg
- –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ XML –æ—Ç–≤–µ—Ç–∞
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –æ—Ç –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞
- –î–µ—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏ –æ—Ç–≤–µ—Ç–∞

### 5. ‚úÖ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∞ –¥–≤–æ–π–Ω–∞—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –Ω–æ–º–µ—Ä–∞
- –ù–æ–º–µ—Ä –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –º–µ—Å—Ç–µ
- –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –Ω–∞ –≤—Å–µ—Ö —ç—Ç–∞–ø–∞—Ö

### 6. ‚úÖ –°–∫—Ä–∏–ø—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
- `npm run check-sms` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- `npm run test-sms` - —Ç–µ—Å—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏ SMS

## üîÑ –¶–ï–ü–û–ß–ö–ê SMS (–ü–û–õ–ù–ê–Ø):

```
1. –ö–ª–∏–µ–Ω—Ç (SMSAuthScreen.tsx)
   ‚Üì
   auth.sendVerificationCode(phone)
   ‚Üì
2. services/auth.ts
   ‚Üì
   POST /api/auth/request-code
   ‚Üì
3. backend/api/auth.ts
   ‚Üì
   requestSmsCode(phone)
   ‚Üì
4. backend/services/authService.ts
   ‚Üì
   - –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –Ω–æ–º–µ—Ä
   - –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫–æ–¥
   - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ –ë–î
   ‚Üì
   sendVerificationCodeSms(phone, code)
   ‚Üì
5. backend/services/smsService.ts
   ‚Üì
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
   - –ù–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç –Ω–æ–º–µ—Ä
   - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —á–µ—Ä–µ–∑ nikita.kg
   ‚Üì
6. nikita.kg API
   ‚Üì
   –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç
   ‚Üì
7. –û–±—Ä–∞—Ç–Ω–æ —á–µ—Ä–µ–∑ –≤—Å—é —Ü–µ–ø–æ—á–∫—É
   ‚Üì
8. –ö–ª–∏–µ–Ω—Ç –ø–æ–ª—É—á–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç
```

## üìã –ß–¢–û –ù–£–ñ–ù–û –ü–†–û–í–ï–†–ò–¢–¨:

### ‚úÖ –®–ê–ì 1: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é

```bash
cd backend
npm run check-sms
```

**–î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å:**
```
‚úÖ SMS –ø—Ä–æ–≤–∞–π–¥–µ—Ä –Ω–∞—Å—Ç—Ä–æ–µ–Ω
   –ü—Ä–æ–≤–∞–π–¥–µ—Ä: nikita
   –û—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å: bat-bat.kg
   –†–µ–∂–∏–º: production
```

### ‚úÖ –®–ê–ì 2: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–í `backend/.env` –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å:
```bash
SMS_LOGIN=superapp
SMS_PASSWORD=83fb772ee0799a422cce18ffd5f497b9
SMS_SENDER=bat-bat.kg
SMS_API_URL=https://smspro.nikita.kg/api/message
NODE_ENV=production  ‚Üê –í–ê–ñ–ù–û!
```

### ‚úÖ –®–ê–ì 3: –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±—ç–∫–µ–Ω–¥

```bash
cd backend
npm run dev
```

**–ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:**
```
‚úÖ SMS –ø—Ä–æ–≤–∞–π–¥–µ—Ä –Ω–∞—Å—Ç—Ä–æ–µ–Ω
   URL: https://smspro.nikita.kg/api/message
   Login: superapp
   Sender: bat-bat.kg
   Mode: production
```

### ‚úÖ –®–ê–ì 4: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏

1. –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ "–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç"
3. –í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: `+996555123456`)
4. –ù–∞–∂–º–∏—Ç–µ "–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–æ–¥"
5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –±—ç–∫–µ–Ω–¥–∞

**–í –ª–æ–≥–∞—Ö –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å:**
```
[AuthAPI] Request code for phone: +996555123456
[AuthService] requestSmsCode called with phone: +996555123456
[AuthService] Formatted phone: +996555123456
[AuthService] Generated code: 1234
[AuthService] Code stored in database, sending SMS...
[SMS] sendSms called with phone: 996555123456
[SMS] Normalized phone: 996555123456
[SMS] Response from nikita.kg: { status: 200, ... }
[SMS] SMS —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ!
```

### ‚úÖ –®–ê–ì 5: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç

**–í development —Ä–µ–∂–∏–º–µ:**
- –ö–æ–¥ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –≤ –ª–æ–≥–∞—Ö –∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
- SMS –ù–ï –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Ä–µ–∞–ª—å–Ω–æ

**–í production —Ä–µ–∂–∏–º–µ:**
- SMS –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Ä–µ–∞–ª—å–Ω–æ —á–µ—Ä–µ–∑ nikita.kg
- –ö–æ–¥ –ø—Ä–∏—Ö–æ–¥–∏—Ç –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω
- –í –ª–æ–≥–∞—Ö –¥–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ—Ç–ø—Ä–∞–≤–∫–µ

## üéØ –ò–¢–û–ì–û–í–ê–Ø –ü–†–û–í–ï–†–ö–ê:

### –í—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –µ—Å–ª–∏:

1. ‚úÖ –ë—ç–∫–µ–Ω–¥ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫ TypeScript
2. ‚úÖ `npm run check-sms` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç "‚úÖ SMS –ø—Ä–æ–≤–∞–π–¥–µ—Ä –Ω–∞—Å—Ç—Ä–æ–µ–Ω"
3. ‚úÖ –ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –±—ç–∫–µ–Ω–¥–∞ –≤–∏–¥–Ω–æ "‚úÖ SMS –ø—Ä–æ–≤–∞–π–¥–µ—Ä –Ω–∞—Å—Ç—Ä–æ–µ–Ω" –∏ "Mode: production"
4. ‚úÖ –í –ª–æ–≥–∞—Ö –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ SMS –µ—Å—Ç—å –¥–µ—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏ –Ω–∞ –≤—Å–µ—Ö —ç—Ç–∞–ø–∞—Ö
5. ‚úÖ –í production —Ä–µ–∂–∏–º–µ SMS –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Ä–µ–∞–ª—å–Ω–æ
6. ‚úÖ –í development —Ä–µ–∂–∏–º–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è testCode

## üö® –ï–°–õ–ò –ù–ï –†–ê–ë–û–¢–ê–ï–¢:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `backend/.env` - –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `NODE_ENV=production` –¥–ª—è —Ä–µ–∞–ª—å–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –±—ç–∫–µ–Ω–¥–∞ - —Ç–∞–º –±—É–¥–µ—Ç –≤–∏–¥–Ω–æ, –Ω–∞ –∫–∞–∫–æ–º —ç—Ç–∞–ø–µ –æ—à–∏–±–∫–∞
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –±–∞–ª–∞–Ω—Å –Ω–∞ —Å—á–µ—Ç—É nikita.kg
5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç –Ω–æ–º–µ—Ä–∞ (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∫—ã—Ä–≥—ã–∑—Å—Ç–∞–Ω—Å–∫–∏–π: 996XXXXXXXXX)

## üìû –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï:

### –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç —á–µ—Ä–µ–∑ curl:

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ SMS
curl http://localhost:3001/api/auth/sms-status

# –¢–µ—Å—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏ SMS
curl -X POST http://localhost:3001/api/auth/request-code \
  -H "Content-Type: application/json" \
  -d '{"phone": "+996555123456"}'
```

### –¢–µ—Å—Ç —á–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç:

```bash
cd backend
npm run test-sms 996555123456
```

## ‚úÖ –í–°–ï –ì–û–¢–û–í–û –ö –†–ê–ë–û–¢–ï!

–°–∏—Å—Ç–µ–º–∞ SMS –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é. –í—Å–µ –æ—à–∏–±–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ, –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –º–µ—Å—Ç–µ.

