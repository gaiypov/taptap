# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö —Ç–∞–±–ª–∏—Ü –≤ Realtime

## üìä –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å

–ü–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏ –≤–∏–¥–Ω–æ, —á—Ç–æ –≤ Realtime –¥–æ–±–∞–≤–ª–µ–Ω—ã —Ç–æ–ª—å–∫–æ **3 –∏–∑ 5** —Ç–∞–±–ª–∏—Ü:

‚úÖ **–î–æ–±–∞–≤–ª–µ–Ω—ã:**
- `chat_threads`
- `chat_messages`
- `listings`

‚ùå **–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç:**
- `listing_likes`
- `listing_saves`

## üîç –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —Å—É—â–µ—Å—Ç–≤—É—é—Ç –ª–∏ —Ç–∞–±–ª–∏—Ü—ã

–í—ã–ø–æ–ª–Ω–∏—Ç–µ –≤ SQL Editor:

```sql
-- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü
SELECT 
  table_name,
  CASE 
    WHEN table_name IS NOT NULL THEN '‚úÖ –¢–∞–±–ª–∏—Ü–∞ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç'
    ELSE '‚ùå –¢–∞–±–ª–∏—Ü–∞ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç'
  END as status
FROM information_schema.tables
WHERE table_schema = 'public'
  AND table_name IN ('listing_likes', 'listing_saves', 'likes', 'saves')
ORDER BY table_name;
```

**–í–æ–∑–º–æ–∂–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã:**
- –¢–∞–±–ª–∏—Ü—ã –º–æ–≥—É—Ç –Ω–∞–∑—ã–≤–∞—Ç—å—Å—è `likes` –∏ `saves` (–±–µ–∑ –ø—Ä–µ—Ñ–∏–∫—Å–∞ `listing_`)
- –¢–∞–±–ª–∏—Ü—ã –º–æ–≥—É—Ç –Ω–∞–∑—ã–≤–∞—Ç—å—Å—è `favorites` –≤–º–µ—Å—Ç–æ `saves`
- –¢–∞–±–ª–∏—Ü—ã –º–æ–≥—É—Ç –Ω–µ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å –≤–æ–æ–±—â–µ

## üîß –®–∞–≥ 2: –î–æ–±–∞–≤—å—Ç–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ —Ç–∞–±–ª–∏—Ü—ã

### –í–∞—Ä–∏–∞–Ω—Ç A: –ï—Å–ª–∏ —Ç–∞–±–ª–∏—Ü—ã –Ω–∞–∑—ã–≤–∞—é—Ç—Å—è `listing_likes` –∏ `listing_saves`

–í—ã–ø–æ–ª–Ω–∏—Ç–µ –≤ SQL Editor:

```sql
-- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ listing_likes
ALTER PUBLICATION supabase_realtime ADD TABLE listing_likes;

-- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ listing_saves
ALTER PUBLICATION supabase_realtime ADD TABLE listing_saves;
```

### –í–∞—Ä–∏–∞–Ω—Ç B: –ï—Å–ª–∏ —Ç–∞–±–ª–∏—Ü—ã –Ω–∞–∑—ã–≤–∞—é—Ç—Å—è `likes` –∏ `saves`

–í—ã–ø–æ–ª–Ω–∏—Ç–µ –≤ SQL Editor:

```sql
-- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ likes
ALTER PUBLICATION supabase_realtime ADD TABLE likes;

-- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ saves
ALTER PUBLICATION supabase_realtime ADD TABLE saves;
```

### –í–∞—Ä–∏–∞–Ω—Ç C: –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç –Ω–∞–∑–≤–∞–Ω–∏—è)

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —Ñ–∞–π–ª:
```
supabase/migrations/20250121_add_missing_realtime_tables.sql
```

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –Ω–∞–∑–≤–∞–Ω–∏–π
2. –î–æ–±–∞–≤–∏—Ç –Ω–∞–π–¥–µ–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã –≤ Realtime
3. –ü–æ–∫–∞–∂–µ—Ç —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å

## ‚úÖ –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å

–ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```sql
-- –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
SELECT 
  tablename,
  '‚úÖ –í–∫–ª—é—á–µ–Ω –≤ Realtime' as status
FROM pg_publication_tables
WHERE pubname = 'supabase_realtime'
  AND tablename IN (
    'chat_threads', 
    'chat_messages', 
    'listings', 
    'listing_likes', 
    'listing_saves',
    'likes',
    'saves',
    'favorites'
  )
ORDER BY tablename;
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –ª–∞–π–∫–∞–º–∏ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è–º–∏.

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–¥–∞ (–µ—Å–ª–∏ –Ω–∞–∑–≤–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü –æ—Ç–ª–∏—á–∞—é—Ç—Å—è)

–ï—Å–ª–∏ –≤–∞—à–∏ —Ç–∞–±–ª–∏—Ü—ã –Ω–∞–∑—ã–≤–∞—é—Ç—Å—è –ø–æ-–¥—Ä—É–≥–æ–º—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, `likes` –≤–º–µ—Å—Ç–æ `listing_likes`), –æ–±–Ω–æ–≤–∏—Ç–µ:

**–§–∞–π–ª: `services/realtime.ts`**

–ù–∞–π–¥–∏—Ç–µ —Å—Ç—Ä–æ–∫–∏:
```typescript
.on('postgres_changes', { event: 'INSERT', schema: 'public', table: 'listing_likes' }, ...)
.on('postgres_changes', { event: 'INSERT', schema: 'public', table: 'listing_saves' }, ...)
```

–ò –∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü:
```typescript
.on('postgres_changes', { event: 'INSERT', schema: 'public', table: 'likes' }, ...)
.on('postgres_changes', { event: 'INSERT', schema: 'public', table: 'saves' }, ...)
```

## üìù –ß–µ–∫–ª–∏—Å—Ç

- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü
- [ ] –û–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü
- [ ] –¢–∞–±–ª–∏—Ü—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ Realtime
- [ ] –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–π–¥–µ–Ω–∞
- [ ] –ö–æ–¥ –æ–±–Ω–æ–≤–ª–µ–Ω (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

---

**–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —à–∞–≥–æ–≤ Realtime –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é!** üéâ

