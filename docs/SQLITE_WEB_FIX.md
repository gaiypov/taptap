# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ expo-sqlite –Ω–∞ Web

## –ü—Ä–æ–±–ª–µ–º–∞

```
Unable to resolve module ./wa-sqlite/wa-sqlite.wasm from expo-sqlite/web/worker.ts
```

## –†–µ—à–µ–Ω–∏–µ

–ò—Å–ø–æ–ª—å–∑—É–µ–º **–ø–ª–∞—Ç—Ñ–æ—Ä–º–æ-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ —Ñ–∞–π–ª—ã** –≤–º–µ—Å—Ç–æ —É—Å–ª–æ–≤–Ω–æ–≥–æ –∏–º–ø–æ—Ä—Ç–∞:

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤:

- `services/offlineStorage.native.ts` - –¥–ª—è iOS/Android (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç SQLite)
- `services/offlineStorage.web.ts` - –¥–ª—è Web (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç AsyncStorage)

### –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. **Metro Bundler** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±–∏—Ä–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–∞–π–ª –ø–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—é:
   - –ù–∞ **web** ‚Üí –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è `offlineStorage.web.ts`
   - –ù–∞ **iOS/Android** ‚Üí –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è `offlineStorage.native.ts`

2. **Custom resolver –≤ metro.config.js** –±–ª–æ–∫–∏—Ä—É–µ—Ç expo-sqlite –Ω–∞ web:
   ```javascript
   if (platform === 'web' && moduleName.includes('expo-sqlite')) {
     return { type: 'empty' };
   }
   ```

3. **blockList** –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç WASM —Ñ–∞–π–ª—ã –∏ web worker:
   ```javascript
   blockList: [
     /node_modules\/expo-sqlite\/web\//,
     /wa-sqlite\/.*\.wasm$/,
   ]
   ```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:

```typescript
// –ò–º–ø–æ—Ä—Ç –æ—Å—Ç–∞–µ—Ç—Å—è –ø—Ä–µ–∂–Ω–∏–º - Metro –≤—ã–±–µ—Ä–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–∞–π–ª
import { initOfflineStorage, cacheListings } from '@/services/offlineStorage';

// –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –≤—Å–µ—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞—Ö –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
await initOfflineStorage();
```

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:

‚úÖ –ù–µ—Ç —É—Å–ª–æ–≤–Ω–æ–≥–æ –∏–º–ø–æ—Ä—Ç–∞ - Metro –Ω–µ –ø—ã—Ç–∞–µ—Ç—Å—è –∑–∞–≥—Ä—É–∑–∏—Ç—å SQLite –Ω–∞ web  
‚úÖ –ß–∏—Å—Ç–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –∫–æ–¥–∞ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º  
‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Ñ–∞–π–ª–∞  
‚úÖ –ù–µ—Ç –æ—à–∏–±–æ–∫ –ø—Ä–∏ —Å–±–æ—Ä–∫–µ –Ω–∞ web  

### –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:

1. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ Metro —Å –æ—á–∏—Å—Ç–∫–æ–π –∫—ç—à–∞:
   ```bash
   npm start --reset-cache
   ```

2. –ò–º–ø–æ—Ä—Ç—ã —É–∂–µ –æ–±–Ω–æ–≤–ª–µ–Ω—ã - –Ω–∏–∫–∞–∫–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –∫–æ–¥–µ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è!

